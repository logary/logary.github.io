<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="X-UA-Compatible" content="IE=edge">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        
        <meta name="author" content="Henrik Feldt">
        <link rel="canonical" href="https://logary.github.io/api/">
        <link rel="shortcut icon" href="../img/favicon.ico">

        <title>API</title>

        <link href="../css/bootstrap-custom.min.css" rel="stylesheet">
        <link href="../css/font-awesome-4.0.3.css" rel="stylesheet">
        <link href="../css/prettify-1.0.css" rel="stylesheet">
        <link href="../css/base.css" rel="stylesheet">
        
            <link href="../../css/fixes.css" rel="stylesheet" />
        

        <!-- HTML5 shim and Respond.js IE8 support of HTML5 elements and media queries -->
        <!--[if lt IE 9]>
            <script src="https://oss.maxcdn.com/libs/html5shiv/3.7.0/html5shiv.js"></script>
            <script src="https://oss.maxcdn.com/libs/respond.js/1.3.0/respond.min.js"></script>
        <![endif]-->
        

        
    </head>

    <body>

        <div class="navbar navbar-default navbar-fixed-top" role="navigation">
    <div class="container">

        <!-- Collapsed navigation -->
        <div class="navbar-header">
            <!-- Expander button -->
            <button type="button" class="navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
                <span class="sr-only">Toggle navigation</span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
                <span class="icon-bar"></span>
            </button>

            <!-- Main title -->
            <a class="navbar-brand" href="..">Logary</a>
        </div>

        <!-- Expanded navigation -->
        <div class="navbar-collapse collapse">
            <!-- Main navigation -->
            <ul class="nav navbar-nav">
            
            
                <li >
                    <a href="..">Home</a>
                </li>
            
            
            
                <li class="active">
                    <a href="./">API</a>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Targets <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../targets/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../targets/textwriter/">TextWriter</a>
                        </li>
                    
                        <li >
                            <a href="../targets/console/">Console</a>
                        </li>
                    
                        <li >
                            <a href="../targets/debugger/">Debugger</a>
                        </li>
                    
                        <li >
                            <a href="../targets/file/">File</a>
                        </li>
                    
                        <li >
                            <a href="../targets/logstash/">Logstash</a>
                        </li>
                    
                        <li >
                            <a href="../targets/graphite/">Graphite</a>
                        </li>
                    
                        <li >
                            <a href="../targets/elmahio/">ElmahIO</a>
                        </li>
                    
                        <li >
                            <a href="../targets/logentries/">Logentries</a>
                        </li>
                    
                        <li >
                            <a href="../targets/loggr/">Loggr</a>
                        </li>
                    
                        <li >
                            <a href="../targets/riemann/">Riemann</a>
                        </li>
                    
                        <li >
                            <a href="../targets/db/">DB</a>
                        </li>
                    
                        <li >
                            <a href="../targets/nimrod/">Nimrod</a>
                        </li>
                    
                        <li >
                            <a href="../targets/dash/">Dash</a>
                        </li>
                    
                        <li >
                            <a href="../targets/zipkin/">Zipkin</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Adapters <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../adapters/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../adapters/eventstore/">EventStore</a>
                        </li>
                    
                        <li >
                            <a href="../adapters/suave/">Suave</a>
                        </li>
                    
                        <li >
                            <a href="../adapters/topshelf/">Topshelf</a>
                        </li>
                    
                        <li >
                            <a href="../adapters/log4net/">log4net</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li class="dropdown">
                    <a href="#" class="dropdown-toggle" data-toggle="dropdown">Advanced <b class="caret"></b></a>
                    <ul class="dropdown-menu">
                    
                        <li >
                            <a href="../advanced/overview/">Overview</a>
                        </li>
                    
                        <li >
                            <a href="../advanced/v2-refactor/">v2.0-refactor</a>
                        </li>
                    
                        <li >
                            <a href="../advanced/reservoirs/">Reservoirs</a>
                        </li>
                    
                        <li >
                            <a href="../advanced/writing-a-target/">Writing a Target</a>
                        </li>
                    
                        <li >
                            <a href="../advanced/writing-a-metric/">Writing a Metric</a>
                        </li>
                    
                        <li >
                            <a href="../advanced/thinking-about-time/">Thinking About Time</a>
                        </li>
                    
                        <li >
                            <a href="../advanced/contributing/">Contributing</a>
                        </li>
                    
                    </ul>
                </li>
            
            
            
                <li >
                    <a href="../about/">About</a>
                </li>
            
            
            </ul>

            <!-- Search, Navigation and Repo links -->
            <ul class="nav navbar-nav navbar-right">
                
                <li >
                    <a rel="next" href="..">
                        <i class="fa fa-arrow-left"></i> Previous
                    </a>
                </li>
                <li >
                    <a rel="prev" href="../targets/overview/">
                        Next <i class="fa fa-arrow-right"></i>
                    </a>
                </li>
                
                <li>
                    <a href="https://github.com/logary/logary/">
                        
                            <i class="fa fa-github"></i>
                        
                        GitHub
                    </a>
                </li>
                
            </ul>
        </div>
    </div>
</div>

        <div class="container">
            <div class="col-md-3"><div class="bs-sidebar hidden-print affix well" role="complementary">
    <ul class="nav bs-sidenav">
    
        <li class="main active"><a href="#api">API</a></li>
        
            <li><a href="#healthchecks-metrics-probes">HealthChecks, Metrics, Probes</a></li>
        
            <li><a href="#c-vb-facade">C# &amp; VB fa√ßade</a></li>
        
    
    </ul>
</div></div>
            <div class="col-md-9" role="main">

<h1 id="api">API</h1>
<p>This package works great with F#:</p>
<pre><code class="fsharp">open System

open NodaTime

open Logary
open Logary.Configuration
open Logary.Targets
open Logary.Metrics

[&lt;EntryPoint&gt;]
let main argv =
  use logary =
    withLogaryManager &quot;Riemann.Example&quot; (
      withTargets [
        Riemann.create (Riemann.RiemannConf.create(tags = [&quot;riemann-health&quot;])) (PointName.ofSingle &quot;riemann&quot;)
        Console.create Console.empty (PointName.ofSingle &quot;console&quot;)
      ] &gt;&gt;
      withMetrics (Duration.FromMilliseconds 5000L) [
        WinPerfCounters.create (WinPerfCounters.Common.cpuTimeConf) (PointName.ofSingle &quot;wperf&quot;)(Duration.FromMilliseconds 300L)
      ] &gt;&gt;
      withRules [
        Rule.createForTarget (PointName.ofSingle &quot;riemann&quot;)
        Rule.createForTarget (PointName.ofSingle &quot;console&quot;)
      ] &gt;&gt;
      withInternalTargets Info [
        Console.create (Console.empty) (PointName.ofSingle &quot;console&quot;)
      ]
    ) |&gt; Hopac.TopLevel.run

  Console.ReadKey true |&gt; ignore
  0
</code></pre>

<p>Now you can get a logger through the <code>Logging</code> module:</p>
<p><strong>F#</strong></p>
<pre><code class="fsharp">let logger = Logging.getCurrentLogger ()
let another = Logging.getLoggerByName &quot;Corp.App.Svc&quot;
let writeLog x = Logary.Logger.log logger x |&gt; Hopac.TopLevel.start
Logary.Message.eventDebug &quot;test&quot; |&gt; writeLog
</code></pre>

<p>or in <strong>C#</strong></p>
<pre><code class="csharp">namespace A {
  class X {
    static readonly Logger _logger = Logging.GetCurrentLogger();
    void XX () {
      _logger.Info(&quot;hello world&quot;);
    }
  }
}
</code></pre>

<p>The Logger module will automatically discover the current
call-site/function/module/class.and use its hierarchy to create a new logger.
The idea is that you can use Rule.hiera regexpes to selectively enable or
disable loggers, just like you can in NLog and log4net.</p>
<p>The static logger is automatically wired up to the framework the instant that
you run the <code>withLogary'</code> or <code>runWithGoodDefaults</code> from the
<code>Logary.Configuration</code> namespace (in which you find the <code>Config</code> module).</p>
<h2 id="healthchecks-metrics-probes">HealthChecks, Metrics, Probes</h2>
<p>Health Checks are like probes, but know how to interpret the results into the
warning-levels of <code>LogLevel</code>.</p>
<p>Metrics: This is currently fairly well-working - have a look at the SQLHealthService for
an example of a Probe.</p>
<h2 id="c-vb-facade">C# &amp; VB fa√ßade</h2>
<p>This facade is useful when you're using C# </p>
<pre><code class="powershell">Install-Package Logary.CSharp
</code></pre>

<p>It adds extension methods to the <code>Logary</code> namespace. Just import the namespace
to get access to the extension methods, while having the nuget/dll referenced.</p>
<pre><code class="csharp">using System;
using System.Data.SQLite;
using System.Text.RegularExpressions;
using FluentMigrator.Runner.Announcers;
using FluentMigrator.Runner.Generators.SQLite;
using FluentMigrator.Runner.Processors.Sqlite;
using Logary;
using Logary.Configuration;
using Logary.DB.Migrations;
using Logary.Target;
using Console = System.Console;

namespace Logary.Specs.Examples
{
    public class When_using_fluent_API
    {
        public void UsageExample()
        {
            var x = LogaryFactory.New(&quot;Logary Specs&quot;,
                with =&gt; with.Target&lt;TextWriter.Builder&gt;(
                    &quot;console1&quot;,
                    conf =&gt;
                    conf.Target.WriteTo(Console.Out, Console.Error)
                        .MinLevel(LogLevel.Verbose)
                        .AcceptIf(line =&gt; true)
                        .SourceMatching(new Regex(&quot;.*&quot;))
                    )
                    .Target&lt;Graphite.Builder&gt;(
                        &quot;graphite&quot;,
                        conf =&gt; conf.Target.ConnectTo(&quot;127.0.0.1&quot;, 2131)
                    )
                    .Target&lt;Debugger.Builder&gt;(&quot;debugger&quot;)
                    .Target&lt;Logstash.Builder&gt;(
                        &quot;ls&quot;,
                        conf =&gt; conf.Target
                            .Hostname(&quot;localhost&quot;)
                            .Port(1936)
                            .EventVersion(Logstash.EventVersion.One)
                            .Done())
                    .Target&lt;DB.Builder&gt;(&quot;db&quot;,
                        conf =&gt; conf.Target
                            .ConnectionFactory(() =&gt; new SQLiteConnection())
                            .DefaultSchema()
                            .MigrateUp(
                                conn =&gt; new SqliteProcessor(conn,
                                    new SqliteGenerator(),
                                    new ConsoleAnnouncer(),
                                    new MigrationOptions(false, &quot;&quot;, 60),
                                    new SqliteDbFactory())))
                );

            var logger = x.GetLogger(&quot;Sample.Config&quot;);

            logger.Log(&quot;Hello world&quot;, LogLevel.Debug, new
                {
                    important = &quot;yes&quot;
                });

            logger.Log(LogLevel.Fatal, &quot;Fatal application error on finaliser thread&quot;);

            logger.Verbose(&quot;immegawd immegawd immegawd!!&quot;, &quot;tag1&quot;, &quot;tag2&quot;);

            var val = logger.TimePath(&quot;sample.config.compute_answer_to_everything&quot;, () =&gt;
                {
                    for (int i = 0; i &lt; 100; i++)
                        System.Threading.Thread.Sleep(1);

                    return 32;
                });

            logger.LogFormat(LogLevel.Warn, &quot;{0} is the answer to the universe and everything&quot;, val);

            logger.Time(() =&gt; logger.Debug(&quot;I wonder how long this takes&quot;, &quot;introspection&quot;, &quot;navel-gazing&quot;));

            try
            {
                throw new ApplicationException(&quot;thing went haywire&quot;);
            }
            catch (Exception e)
            {
                logger.DebugException(&quot;expecting haywire, so we're telling with debug&quot;, e, &quot;haywire&quot;, &quot;external&quot;);
            }
        }
    }
}
</code></pre></div>
        </div>

        

        <script src="https://code.jquery.com/jquery-1.10.2.min.js"></script>
        <script src="../js/bootstrap-3.0.3.min.js"></script>
        <script src="../js/prettify-1.0.min.js"></script>
        <script src="../js/base.js"></script>
    </body>
</html>